webpackJsonp([11],{eApe:function(s,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=a("7+uW"),r=a("zL8q");t.default.use(r.Table),t.default.use(r.Dialog),t.default.use(r.TableColumn);var i={created(){this.getUserlists(),localStorage.removeItem("blockchainMoNavIndex")},data:()=>({addUserFlag:!1,editPassFlag:!1,editPassParams:{},setUserFlag:!1,setUserParams:{},delUserId:"",delUserIndex:999,delUserFlag:!1,delPassword:"",addUserParams:{user_name:"",password:"",againpassword:"",role:1},operFlag:!0,userLists:[]}),methods:{getUserlists(){this.$http.get("/deploy_user/list",{params:{}}).then(({data:s})=>{this.userLists=s.data}).catch(({data:s})=>{})},clickSetUser(s,e,a){this[e]=!0,this[a]=s},setUser(){let s={};if(this.editPassParams.user_id){if(s=this.editPassParams,!this.editPassParams.password||!this.editPassParams.againpassword)return this.$message({message:"请完善信息",type:"warning"}),!1}else if(s=this.setUserParams,!this.setUserParams.user_name||!this.setUserParams.password||!this.setUserParams.againpassword)return this.$message({message:"请完善信息",type:"warning"}),!1;return s.password!==s.againpassword?(this.$message({message:"两次密码不一致",type:"warning"}),!1):!!this.operFlag&&(this.operFlag=!1,void this.$http.post("/deploy_user/Update",s).then(({data:s})=>{let e="warning";"0"===s.code&&(e="success",this.editPassParams={},this.setUserParams={},this.getUserlists()),this.$message({message:s.data,type:e,duration:1500}),setTimeout(()=>{this.editPassFlag=!1,this.setUserFlag=!1},1600)}).catch(({data:s})=>{console.log(s,2222),this.operFlag=!0}))},clickDelBtn(s,e){this.delUserId=s,this.delUserIndex=e,this.delUserFlag=!0},deleteUser(){let s={user_id:this.delUserId,delPassword:""};if(!this.operFlag)return!1;this.operFlag=!1,this.$http.post("/deploy_user/detele",s).then(({data:s})=>{let e="warning";if("0"===s.code){let s=this.userLists;s.splice(this.delUserIndex,1),this.userLists=s,e="success"}this.$message({message:s.data,type:e,duration:1500}),this.delPassword="",setTimeout(()=>{this.delUserFlag=!1},1600),this.operFlag=!0}).catch(({data:s})=>{this.$message({message:s.data,type:"warning"}),this.delPassword="",this.operFlag=!0,this.operFlag=!0})},addUser(){if(!this.addUserParams.password||!this.addUserParams.againpassword||!this.addUserParams.user_name)return this.$message({message:"请完善信息",type:"success"}),!1;if(this.addUserParams.password!==this.addUserParams.againpassword)return this.$message({message:"两次密码不一致",type:"success"}),!1;let s=Object.assign({},this.addUserParams);if(s.role-=0,delete s.againpassword,!this.operFlag)return!1;this.operFlag=!1,this.$http.post("/deploy_user/Add",s).then(({data:s})=>{this.addUserFlag=!1;let e="warning";"0"===s.code&&(e="success",this.getUserlists()),this.$message({message:s.data,type:e}),this.operFlag=!0}).catch(({data:s})=>{this.$message({message:s.data,type:"warning"}),this.operFlag=!0})}}},l={render:function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("div",{staticClass:"outer_wrap blockchainManagement usermanagementWrap"},[a("div",{staticClass:"containerTopTitle"},[s._v("用户管理")]),s._v(" "),a("div",{staticClass:"blockManagement_TopTile"},[a("div",[s._v("用户列表")]),s._v(" "),a("span",{on:{click:function(e){s.deployFlag=!0}}},[s._v("添加用户")])]),s._v(" "),a("div",{staticClass:"blockMangement_listsWrap"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:s.userLists,border:""}},[a("el-table-column",{attrs:{fixed:"",prop:"user_id",label:"用户ID"}}),s._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"用户名"}}),s._v(" "),a("el-table-column",{attrs:{label:"用户类型"},scopedSlots:s._u([{key:"default",fn:function(e){return[a("span",[s._v(s._s(s._f("userType")(e.row.role)))])]}}])}),s._v(" "),a("el-table-column",{attrs:{prop:"user_id",label:"创建时间"},scopedSlots:s._u([{key:"default",fn:function(e){return[a("span",[s._v(s._s(e.row.create_time))])]}}])}),s._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:s._u([{key:"default",fn:function(e){return[a("span",{staticClass:"usermanagementListOperBtn",on:{click:function(a){a.preventDefault(),s.clickSetUser(e.row,"editPassFlag","editPassParams")}}},[s._v("修改密码")]),s._v(" "),a("span",{staticClass:"usermanagementListOperBtn",on:{click:function(a){a.preventDefault(),s.clickSetUser(e.row,"setUserFlag","setUserParams")}}},[s._v("设置")]),s._v(" "),a("span",{staticClass:"usermanagementListOperBtn",on:{click:function(a){a.preventDefault(),s.clickDelBtn(e.row.user_id,e.$index)}}},[s._v("删除")])]}}])})],1)],1),s._v(" "),a("el-dialog",{attrs:{title:"添加用户",visible:s.addUserFlag},on:{"update:visible":function(e){s.addUserFlag=e}}},[a("div",{staticClass:"userOperateListsWrap"},[a("div",[a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("用户名")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.addUserParams.user_name,expression:"addUserParams.user_name"}],attrs:{placeholder:"请输入用户名",type:"text"},domProps:{value:s.addUserParams.user_name},on:{input:function(e){e.target.composing||s.$set(s.addUserParams,"user_name",e.target.value)}}})]),s._v(" "),a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("设定密码")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.addUserParams.password,expression:"addUserParams.password"}],attrs:{type:"password"},domProps:{value:s.addUserParams.password},on:{input:function(e){e.target.composing||s.$set(s.addUserParams,"password",e.target.value)}}})])]),s._v(" "),a("div",[a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("用户类型")]),s._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:s.addUserParams.role,expression:"addUserParams.role"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(s){return s.selected}).map(function(s){return"_value"in s?s._value:s.value});s.$set(s.addUserParams,"role",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"0"}},[s._v("超级用户")]),s._v(" "),a("option",{attrs:{value:"1"}},[s._v("常规用户")])])]),s._v(" "),a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("再次输入密码")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.addUserParams.againpassword,expression:"addUserParams.againpassword"}],attrs:{type:"password"},domProps:{value:s.addUserParams.againpassword},on:{input:function(e){e.target.composing||s.$set(s.addUserParams,"againpassword",e.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"userOperateBtn",on:{click:s.addUser}},[s._v("确定")])])]),s._v(" "),a("el-dialog",{attrs:{title:"修改密码",visible:s.editPassFlag},on:{"update:visible":function(e){s.editPassFlag=e}}},[a("div",{staticClass:"userDelListsWrap"},[a("input",{directives:[{name:"model",rawName:"v-model",value:s.editPassParams.password,expression:"editPassParams.password"}],attrs:{placeholder:"请设定新密码",type:"password"},domProps:{value:s.editPassParams.password},on:{input:function(e){e.target.composing||s.$set(s.editPassParams,"password",e.target.value)}}}),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.editPassParams.againpassword,expression:"editPassParams.againpassword"}],attrs:{placeholder:"请再次输入新密码",type:"password"},domProps:{value:s.editPassParams.againpassword},on:{input:function(e){e.target.composing||s.$set(s.editPassParams,"againpassword",e.target.value)}}})]),s._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"userDelBtnWrap"},[a("div",{staticClass:"userDelBtn userEditBtn",on:{click:s.setUser}},[s._v("确认")]),s._v(" "),a("div",{staticClass:"userDelBtn",on:{click:function(e){s.editPassFlag=!1}}},[s._v("取消")])])])]),s._v(" "),a("el-dialog",{attrs:{title:"用户设置",visible:s.setUserFlag},on:{"update:visible":function(e){s.setUserFlag=e}}},[a("div",{staticClass:"userOperateListsWrap"},[a("div",[a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("用户名")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.setUserParams.user_name,expression:"setUserParams.user_name"}],attrs:{placeholder:"请输入用户名",type:"text"},domProps:{value:s.setUserParams.user_name},on:{input:function(e){e.target.composing||s.$set(s.setUserParams,"user_name",e.target.value)}}})]),s._v(" "),a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("设定密码")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.setUserParams.password,expression:"setUserParams.password"}],attrs:{type:"password"},domProps:{value:s.setUserParams.password},on:{input:function(e){e.target.composing||s.$set(s.setUserParams,"password",e.target.value)}}})])]),s._v(" "),a("div",[a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("用户类型")]),s._v(" "),a("select",{directives:[{name:"model",rawName:"v-model",value:s.setUserParams.role,expression:"setUserParams.role"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(s){return s.selected}).map(function(s){return"_value"in s?s._value:s.value});s.$set(s.setUserParams,"role",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:"0"}},[s._v("超级用户")]),s._v(" "),a("option",{attrs:{value:"1"}},[s._v("常规用户")])])]),s._v(" "),a("div",{staticClass:"userOperateListWrap"},[a("div",[s._v("再次输入密码")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.setUserParams.againpassword,expression:"setUserParams.againpassword"}],attrs:{type:"password"},domProps:{value:s.setUserParams.againpassword},on:{input:function(e){e.target.composing||s.$set(s.setUserParams,"againpassword",e.target.value)}}})])])]),s._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"userOperateBtn",on:{click:s.setUser}},[s._v("确定")])])]),s._v(" "),a("el-dialog",{attrs:{title:"删除用户",visible:s.delUserFlag},on:{"update:visible":function(e){s.delUserFlag=e}}},[a("div",{staticClass:"userDelListsWrap"},[a("span",[s._v("⚠️请在此确认是否要删除用户username？")]),s._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:s.delPassword,expression:"delPassword"}],attrs:{placeholder:"请输入管理员密码",type:"password"},domProps:{value:s.delPassword},on:{input:function(e){e.target.composing||(s.delPassword=e.target.value)}}})]),s._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"userDelBtnWrap"},[a("div",{staticClass:"userDelBtn",on:{click:s.deleteUser}},[s._v("确认删除")]),s._v(" "),a("div",{staticClass:"userDelBtn",on:{click:function(e){s.delUserFlag=!1}}},[s._v("取消")])])])])],1)},staticRenderFns:[]};var d=a("VU/8")(i,l,!1,function(s){a("m2Md")},null,null);e.default=d.exports},m2Md:function(s,e){}});
//# sourceMappingURL=11.976dfe1ea8cfc1139607.js.map